import{u as N,r as f,j as s,R as u,a as E,g as p,b as y,f as w}from"./index-Cm7cDu_g.js";const b=({events:m,direction:r="grid"})=>{const g=N(),[x,d]=f.useState({}),o=m.slice(0,4),c=o.length<4,h=n=>{console.log(`ðŸ–¼ï¸ Image loaded: ${n}`),d(l=>({...l,[n]:!0}))},v=(n,l)=>{var t;console.log(`âŒ Image failed to load: ${n}`);const e=l.target;e.style.display="none",(t=e.nextElementSibling)==null||t.classList.add("show-fallback"),d(a=>({...a,[n]:!0}))},j=n=>{if(!n)return{text:"no date",isPast:!1};const l=new Date(n),e=new Date,t=l.getTime()-e.getTime(),a=Math.ceil(t/(1e3*60*60*24));let i;const D=a<0;return a===0?i="today":a===1?i="tomorrow":a===-1?i="yesterday":a>0?i=`in ${a} days`:i=`${Math.abs(a)} days ago`,{text:i,isPast:D}};return s.jsx("div",{className:"reel-tile-container",children:s.jsx("div",{className:`${r==="grid"?"reel-tile-grid":"reel-tile-slider"} ${r==="grid"&&c?"few-events":""}`,children:o.map((n,l)=>{const e=n.imageUrl,t=e?x[e]:!1;return s.jsx("div",{className:"reel-tile-item",children:s.jsxs("div",{onClick:()=>{g(`/reel/${n.id}`)},className:"reel-tile-image-container",children:[e?s.jsx("img",{src:`https://img.event-scanner.com/insecure/rs:fill:200:200/plain/${e}@webp`,alt:n.title,className:`reel-tile-image ${t?"loaded":"loading"}`,loading:"lazy",onLoad:()=>h(e),onError:a=>v(e,a)}):null,s.jsx("div",{className:`reel-tile-fallback ${e?"":"show-fallback"}`,style:{background:"linear-gradient(45deg, #667eea 0%, #764ba2 100%)"}}),e&&!t&&s.jsx("div",{className:"reel-tile-loading",children:s.jsx("div",{className:"loading-spinner"})}),s.jsx("div",{className:"reel-tile-overlay",children:s.jsxs("div",{className:"reel-tile-content",children:[s.jsx("h3",{className:"reel-tile-title",children:n.title}),(()=>{const a=j(n.startDate);return s.jsx("p",{className:`reel-tile-date ${a.isPast?"past":""}`,children:a.text})})()]})})]})},n.id||l)})})})},I=({events:m})=>{const r=e=>e.id||e._id,g=new Date,x=new Date(g.setHours(0,0,0,0)),{upcomingEvents:d,todayEvents:o,pastEvents:c}=m.reduce((e,t)=>{if(!t.startDate)return e;const a=new Date(t.startDate);return new Date(a.setHours(0,0,0,0)).getTime()===x.getTime()?e.todayEvents.push(t):a>g?e.upcomingEvents.push(t):e.pastEvents.push(t),e},{upcomingEvents:[],todayEvents:[],pastEvents:[]});d.sort((e,t)=>new Date(e.startDate).getTime()-new Date(t.startDate).getTime()),c.sort((e,t)=>new Date(t.startDate).getTime()-new Date(e.startDate).getTime());const h=e=>e.reduce((t,a)=>{const i=w(a.startDate);return t[i]||(t[i]=[]),t[i].push(a),t},{}),v=h(d),j=h(c),n=()=>Math.random()<.5,l=e=>{const t=[...e].sort(()=>.5-Math.random());return t.slice(0,Math.min(5,t.length))};return s.jsxs("div",{className:"event-gallery-container",children:[s.jsxs("div",{className:"event-list",children:[s.jsx("div",{className:"event-date-heading-container",children:o.length>0&&s.jsx("h2",{className:"section-title",children:"Today"})}),s.jsx("div",{className:"event-date-section",children:s.jsx("div",{className:"real-event-list-item-container",children:o.map(e=>s.jsx("div",{children:s.jsx(u,{event:e},r(e))},r(e)))})}),Object.keys(v).length>0&&Object.entries(v).map(([e,t],a)=>s.jsxs(E.Fragment,{children:[s.jsxs("div",{className:"event-date-heading-container",children:[s.jsx("h2",{className:"section-title",children:e}),s.jsx("h3",{className:"event-date-heading-sub",children:p(e)===1?"tomorrow":`in ${p(e)} days`})]}),s.jsx("div",{className:"event-date-section",children:s.jsx("div",{className:"real-event-list-item-container",children:t.map(i=>s.jsx("div",{children:s.jsx(u,{event:i},r(i))},r(i)))})})]},e))]}),c.length>0&&s.jsx(s.Fragment,{children:s.jsx("div",{className:"event-list",children:Object.entries(j).map(([e,t])=>s.jsxs("div",{className:"event-date-section",children:[s.jsxs("div",{className:"event-date-heading-container",children:[s.jsx("h2",{className:"section-title",children:e}),s.jsx("h3",{className:"event-date-heading-sub event-date-heading-sub-past",children:y(e)<=1?"yesterday":`${y(e)} days ago`})]}),n()&&s.jsx(b,{events:l(m)}),s.jsx("div",{className:"real-event-list-item-container",children:t.map(a=>s.jsx(u,{event:a,isPast:!0},r(a)))})]},e))})})]})};export{I as EventGalleryII};
